pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out code from Git...'
                checkout([$class: 'GitSCM', branches: [[name: '*/master']],
			extensions: [],
			userRemoteConfigs: [[url: 'https://github.com/DaliDevops/MyProject.git']]])
            }
        }

        stage('Build') {
            steps {
                echo 'Building Angular project...'
                sh 'npm install'
                sh 'npm run build'
            }
        }
        }

        stage('Deploy') {
            steps {
                echo 'Deploying Angular project to GitHub Pages...'
                sh 'npm install -g angular-cli-ghpages'
                sh 'ng build --prod --base-href "https://DaliDevops.github.io/angularproject/"'
                sh 'ngh --dir=dist/angularproject'
            }
        }
}
post {
		success{
		mail bcc: '', body: '''Dear Dali, 
we are happy to inform you that your pipeline build was successful. 
Great work ! 
-Jenkins Team-''', cc: '', from: 'dali2008fr@hotmail.fr', replyTo: '', subject: 'Build Finished - Success', to: 'dali2008fr@hotmail.fr'
		}
		
		failure{
mail bcc: '', body: '''Dear Dali, 
we are sorry to inform you that your pipeline build failed. 
Keep working ! 
-Jenkins Team-''', cc: '', from: 'dali2008fr@hotmail.fr', replyTo: '', subject: 'Build Finished - Failure', to: 'dali2008fr@hotmail.fr'
		}

       always {
		//emailext attachLog: true, body: '', subject: 'Build finished',from: 'dali2008fr@hotmail.fr' , to: 'dali2008fr@hotmail.fr'
            cleanWs()
       }
    }
